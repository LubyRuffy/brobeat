- key: conn
  title: conn
  description: >
    TCP/UDP/ICMP connections
  fields:
    - name: conn
      type: group
      fields:
        - name: ts
          description: >
            This is the time of the first packet.
        - name: uid
          description: >
            A unique identifier of the connection.
        - name: id.orig_h
          description: >
            The originators IP address.
        - name: id.orig_p
          description: >
            The originators port number.
        - name: id.resp_h
          description: >
            The responders IP address.
        - name: id.resp_p
          description: >
            The responders port number.
        - name: proto
          description: >
            The transport layer protocol of the connection.
        - name: service
          description: >
            An identification of an application protocol being sent over the connection.
        - name: duration
          description: >
            How long the connection lasted.  For 3-way or 4-way connection tear-downs, this will not include the final ACK.
        - name: orig_bytes
          description: >
            The number of payload bytes the originator sent. For TCP this is taken from sequence numbers and might be inaccurate (e.g., due to large connections).
        - name: resp_bytes
          description: >
            The number of payload bytes the responder sent. See orig_bytes.
        - name: conn_state
        - name: local_orig
          description: >
            If the connection is originated locally, this value will be T. If it was originated remotely it will be F.  In the case that the Site::local_nets variable is undefined, this field will be left empty at all times.
        - name: local_resp
          description: >
            If the connection is responded to locally, this value will be T. If it was responded to remotely it will be F.  In the case that the Site::local_nets variable is undefined, this field will be left empty at all times.
        - name: missed_bytes
          description: >
            Indicates the number of bytes missed in content gaps, which is representative of packet loss.  A value other than zero will normally cause protocol analysis to fail but some analysis may have been completed prior to the packet loss.
        - name: history
          description: >
            Records the state history of connections as a string of letters.  The meaning of those letters is:
        - name: orig_pkts
          description: >
            Number of packets that the originator sent. Only set if use_conn_size_analyzer = T.
        - name: orig_ip_bytes
          description: >
            Number of IP level bytes that the originator sent (as seen on the wire, taken from the IP total_length header field). Only set if use_conn_size_analyzer = T.
        - name: resp_pkts
          description: >
            Number of packets that the responder sent. Only set if use_conn_size_analyzer = T.
        - name: resp_ip_bytes
          description: >
            Number of IP level bytes that the responder sent (as seen on the wire, taken from the IP total_length header field). Only set if use_conn_size_analyzer = T.
        - name: tunnel_parents
          description: >
            If this connection was over a tunnel, indicate the uid values for any encapsulating parent connections used over the lifetime of this inner connection.
        - name: orig_l2_addr
          description: >
            (present if policy/protocols/conn/mac-logging.bro is loaded)
        - name: resp_l2_addr
          description: >
            (present if policy/protocols/conn/mac-logging.bro is loaded)
        - name: vlan
          description: >
            (present if policy/protocols/conn/vlan-logging.bro is loaded)
        - name: inner_vlan
          description: >
            (present if policy/protocols/conn/vlan-logging.bro is loaded)
