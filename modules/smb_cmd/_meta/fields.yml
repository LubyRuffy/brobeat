- key: smb_cmd
  title: smb_cmd
  description: >
    SMB commands
  fields:
    - name: smb_cmd
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp of the command request.
        - name: uid
          type: text
          description: >
            Unique ID of the connection the request was sent over.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: command
          type: keyword
          description: >
            The command sent by the client.
        - name: sub_command
          type: keyword
          description: >
            The subcommand sent by the client, if present.
        - name: argument
          type: keyword
          description: >
            Command argument sent by the client, if any.
        - name: status
          type: keyword
          description: >
            Server reply to the clients command.
        - name: rtt
          type: double
          description: >
            Round trip time from the request to the response.
        - name: version
          type: keyword
          description: >
            Version of SMB for the command.
        - name: username
          type: keyword
          description: >
            Authenticated username, if available.
        - name: tree
          type: keyword
          description: >
            If this is related to a tree, this is the tree that was used for the current command.
        - name: tree_service
          type: keyword
          description: >
            The type of tree (disk share, printer share, named pipe, etc.).
        - name: referenced_file
          description: >
            If the command referenced a file, store it here.
        - name: referenced_tree
          description: >
            If the command referenced a tree, store it here.
        - name: smb1_offered_dialects
          description: >
            (present if policy/protocols/smb/smb1-main.bro is loaded)
        - name: smb2_offered_dialects
          description: >
            (present if policy/protocols/smb/smb2-main.bro is loaded)

