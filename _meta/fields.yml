- key: common
  title: "Common"
  description: Common Fields.
  fields:
    - name: counter
      type: integer
      description: >
        Log line count.
    - name: type
      type: text
      description: >
        Log type.
    - name: created
      type: date
      description: >
        Log created date.

- key: http
  title: "Http"
  description: AMQP specific event fields.
  fields:
    - name: ts
      type: double
      description: >
        Timestamp for when the request happened.
    - name: uid
      type: text
      description: >
        Unique ID for the connection.
    - name: id.orig_h
      type: ip
      description: >
        The originator's IP address.
    - name: id.orig_p
      type: integer
      description: >
        The originator's port number.
    - name: id.resp_h
      type: ip
      description: >
        The responder's IP address.
    - name: id.resp_p
      type: integer
      description: >
        The responder's port number.
    - name: trans_depth
      type: integer
      description: >
        Represents the pipelined depth into the connection of this request/response transaction.
    - name: method
      type: keyword
      description: >
        Verb used in the HTTP request (GET, POST, HEAD, etc.).
    - name: host
      description: >
        Value of the HOST header.
    - name: uri
      description: >
        URI used in the request.
    - name: referrer
      type: text
      description: >
        Value of the referer header.  The comment is deliberately misspelled like the standard declares, but the name used here is referrer spelled correctly.
    - name: version
      type: text
      description: >
        Value of the version portion of the request.
    - name: user_agent
      type: text
      description: >
        Value of the User-Agent header from the client.
    - name: request_body_len
      type: integer
      description: >
        Actual uncompressed content size of the data transferred from the client.
    - name: response_body_len
      type: integer
      description: >
        Actual uncompressed content size of the data transferred from the server.
    - name: status_code
      type: integer
      description: >
        Status code returned by the server.
    - name: status_msg
      type: text
      description: >
        Status message returned by the server.
    - name: info_code
      type: integer
      description: >
        Last seen 1xx informational reply code returned by the server.
    - name: info_msg
      type: text
      description: >
        Last seen 1xx informational reply message returned by the server.
    # - name: tags
    #   description: >
    #     A set of indicators of various attributes discovered and related to a particular request/response pair.
    - name: username
      type: text
      description: >
        Username if basic-auth is performed for the request.
    - name: password
      type: text
      description: >
        Password if basic-auth is performed for the request.
    - name: capture_password
      type: boolean
      description: >
        Determines if the password will be captured for this request.
    - name: proxied
      description: >
        All of the headers that may indicate if the request was proxied.
    - name: range_request
      type: boolean
      description: >
        Indicates if this request can assume 206 partial content in response.
    - name: orig_fuids
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: orig_filenames
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: orig_mime_types
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: resp_fuids
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: resp_filenames
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: resp_mime_types
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: current_entity.filename
      type: text
      description: >
        Filename for the entity if discovered from a header.
    - name: orig_mime_depth
      type: integer
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: resp_mime_depth
      type: integer
      description: >
        (present if base/protocols/http/entities.bro is loaded)
    - name: client_header_names
      description: >
        (present if policy/protocols/http/header-names.bro is loaded)
    - name: server_header_names
      description: >
        (present if policy/protocols/http/header-names.bro is loaded)
    - name: omniture
      type: boolean
      description: >
        (present if policy/protocols/http/software-browser-plugins.bro is loaded)
    - name: flash_version
      type: text
      description: >
        (present if policy/protocols/http/software-browser-plugins.bro is loaded)
    - name: cookie_vars
      description: >
        (present if policy/protocols/http/var-extraction-cookies.bro is loaded)
    - name: uri_vars
      description: >
        (present if policy/protocols/http/var-extraction-uri.bro is loaded)


- key: files
  title: "Files"
  description: File analysis results
  fields:
    # - name: ts
    #   type: double
    #   description: >
    #     The time when the file was first seen.
    - name: fuid
      type: text
      description: >
        An identifier associated with a single file.
    - name: tx_hosts
      description: >
        If this file was transferred over a network connection this should show the host or hosts that the data sourced from.
    - name: rx_hosts
      description: >
        If this file was transferred over a network connection this should show the host or hosts that the data traveled to.
    - name: conn_uids
      description: >
        Connection UIDs over which the file was transferred.
    - name: source
      type: text
      description: >
        An identification of the source of the file data.  E.g. it may be a network protocol over which it was transferred, or a local file path which was read, or some other input source.
    - name: depth
      type: integer
      description: >
        A value to represent the depth of this file in relation to its source.  In SMTP, it is the depth of the MIME attachment on the message.  In HTTP, it is the depth of the request within the TCP connection.
    - name: analyzers
      description: >
        A set of analysis types done during the file analysis.
    - name: mime_type
      type: text
      description: >
        A mime type provided by the strongest file magic signature match against the bof_buffer field of fa_file, or in the cases where no buffering of the beginning of file occurs, an initial guess of the mime type based on the first data seen.
    - name: filename
      type: text
      description: >
        A filename for the file if one is available from the source for the file.  These will frequently come from Content-Disposition headers in network protocols.
    - name: duration
      type: double
      description: >
        The duration the file was analyzed for.
    - name: local_orig
      type: boolean
      description: >
        If the source of this file is a network connection, this field indicates if the data originated from the local network or not as determined by the configured Site::local_nets.
    - name: is_orig
      type: boolean
      description: >
        If the source of this file is a network connection, this field indicates if the file is being sent by the originator of the connection or the responder.
    - name: seen_bytes
      type: integer
      description: >
        Number of bytes provided to the file analysis engine for the file.
    - name: total_bytes
      type: integer
      description: >
        Total number of bytes that are supposed to comprise the full file.
    - name: missing_bytes
      type: integer
      description: >
        The number of bytes in the file stream that were completely missed during the process of analysis e.g. due to dropped packets.
    - name: overflow_bytes
      type: integer
      description: >
        The number of bytes in the file stream that were not delivered to stream file analyzers.  This could be overlapping bytes or bytes that couldnt be reassembled.
    - name: timedout
      type: boolean
      description: >
        Whether the file analysis timed out at least once for the file.
    - name: parent_fuid
      type: text
      description: >
        Identifier associated with a container file from which this one was extracted as part of the file analysis.
    - name: md5
      type: text
      description: >
        (present if base/files/hash/main.bro is loaded)
    - name: sha1
      type: text
      description: >
        (present if base/files/hash/main.bro is loaded)
    - name: sha256
      type: text
      description: >
        (present if base/files/hash/main.bro is loaded)
    - name: x509.ts
      type: double
      description: >
        Current timestamp.
    - name: x509.id
      type: text
      description: >
        File id of this certificate.
    - name: x509.certificate
      description: >
        Basic information about the certificate.
    - name: x509.handle
      description: >
        The opaque wrapping the certificate. Mainly used for the verify operations.
    - name: x509.extensions
      description: >
        All extensions that were enintegerered in the certificate.
    - name: x509.san
      description: >
        Subject alternative name extension of the certificate.
    - name: x509.basic_constraints
      description: >
        Basic constraints extension of the certificate.
    - name: x509.logcert
      type: boolean
      description: >
        (present if policy/protocols/ssl/log-hostcerts-only.bro is loaded)
    - name: extracted
      type: text
      description: >
        (present if base/files/extract/main.bro is loaded)
    - name: entropy
      type: double
      description: >
        (present if policy/frameworks/files/entropy-test-all-files.bro is loaded)
