- key: barnyard2
  title: barnyard2
  description: >
    Alerts received from Barnyard2
  fields:
    - name: barnyard2
      type: group
      fields:
        - name: ts
          type: double
        - name: pid
        - name: alert

- key: capture_loss
  title: capture_loss
  description: >
    Packet loss rate
  fields:
    - name: capture_loss
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the measurement occurred.
        - name: ts_delta
          type: double
          description: >
            The time delay between this measurement and the last.
        - name: peer
          type: keyword
          description: >
            In the event that there are multiple Bro instances logging to the same host, this distinguishes each peer with its individual name.
        - name: gaps
          type: integer
          description: >
            Number of missed ACKs from the previous measurement interval.
        - name: acks
          type: integer
          description: >
            Total number of ACKs seen in the previous measurement interval.
        - name: percent_lost
          type: double
          description: >
            Percentage of ACKs seen where the data being ACKed wasnt seen.

- key: cluster
  title: cluster
  description: >
    Bro cluster messages
  fields:
    - name: cluster
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time at which a cluster message was generated.
        - name: message
          type: keyword
          description: >
            A message indicating information about the clusters operation.

- key: communication
  title: communication
  description: >
    Communication events between Bro or Broccoli instances
  fields:
    - name: communication
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The network time at which a communication event occurred.
        - name: peer
          type: keyword
          description: >
            The peer name (if any) with which a communication event is concerned.
        - name: src_name
          type: keyword
          description: >
            Where the communication event message originated from, that is, either from the scripting layer or inside the Bro process.
        - name: connected_peer_desc
          type: keyword
          description: >
            Todo
        - name: connected_peer_addr
          type: ip
          description: >
            Todo
        - name: connected_peer_port
          type: integer
          description: >
            Todo
        - name: level
          type: keyword
          description: >
            The severity of the communication event message.
        - name: message
          type: keyword
          description: >
            A message describing the communication event between Bro or Broccoli instances.

- key: conn
  title: conn
  description: >
    TCP/UDP/ICMP connections
  fields:
    - name: conn
      type: group
      fields:
        - name: ts
          type: double
          description: >
            This is the time of the first packet.
        - name: uid
          type: text
          description: >
            A unique identifier of the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: proto
          type: keyword
          description: >
            The transport layer protocol of the connection.
        - name: service
          type: keyword
          description: >
            An identification of an application protocol being sent over the connection.
        - name: duration
          type: double
          description: >
            How long the connection lasted.  For 3-way or 4-way connection tear-downs, this will not include the final ACK.
        - name: orig_bytes
          type: integer
          description: >
            The number of payload bytes the originator sent. For TCP this is taken from sequence numbers and might be inaccurate (e.g., due to large connections).
        - name: resp_bytes
          type: integer
          description: >
            The number of payload bytes the responder sent. See orig_bytes.
        - name: conn_state
          type: keyword
        - name: local_orig
          type: boolean
          description: >
            If the connection is originated locally, this value will be T. If it was originated remotely it will be F.  In the case that the Site::local_nets variable is undefined, this field will be left empty at all times.
        - name: local_resp
          type: boolean
          description: >
            If the connection is responded to locally, this value will be T. If it was responded to remotely it will be F.  In the case that the Site::local_nets variable is undefined, this field will be left empty at all times.
        - name: missed_bytes
          type: integer
          description: >
            Indicates the number of bytes missed in content gaps, which is representative of packet loss.  A value other than zero will normally cause protocol analysis to fail but some analysis may have been completed prior to the packet loss.
        - name: history
          type: keyword
          description: >
            Records the state history of connections as a string of letters.  The meaning of those letters is:
        - name: orig_pkts
          type: integer
          description: >
            Number of packets that the originator sent. Only set if use_conn_size_analyzer = T.
        - name: orig_ip_bytes
          type: integer
          description: >
            Number of IP level bytes that the originator sent (as seen on the wire, taken from the IP total_length header field). Only set if use_conn_size_analyzer = T.
        - name: resp_pkts
          type: integer
          description: >
            Number of packets that the responder sent. Only set if use_conn_size_analyzer = T.
        - name: resp_ip_bytes
          type: integer
          description: >
            Number of IP level bytes that the responder sent (as seen on the wire, taken from the IP total_length header field). Only set if use_conn_size_analyzer = T.
        - name: tunnel_parents
          description: >
            If this connection was over a tunnel, indicate the uid values for any encapsulating parent connections used over the lifetime of this inner connection.
        - name: orig_l2_addr
          type: keyword
          description: >
            (present if policy/protocols/conn/mac-logging.bro is loaded)
        - name: resp_l2_addr
          type: keyword
          description: >
            (present if policy/protocols/conn/mac-logging.bro is loaded)
        - name: vlan
          type: integer
          description: >
            (present if policy/protocols/conn/vlan-logging.bro is loaded)
        - name: inner_vlan
          type: integer
          description: >
            (present if policy/protocols/conn/vlan-logging.bro is loaded)

- key: dce_rpc
  title: dce_rpc
  description: >
    Distributed Computing Environment/RPC
  fields:
    - name: dce_rpc
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: rtt
          type: double
          description: >
            Round trip time from the request to the response. If either the request or response wasnt seen, this will be null.
        - name: named_pipe
          type: keyword
          description: >
            Remote pipe name.
        - name: endpoint
          type: keyword
          description: >
            Endpoint name looked up from the uuid.
        - name: operation
          type: keyword
          description: >
            Operation seen in the call.

- key: dhcp
  title: dhcp
  description: >
    DHCP leases
  fields:
    - name: dhcp
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The earliest time at which a DHCP message over the associated connection is observed.
        - name: uid
          type: text
          description: >
            A unique identifier of the connection over which DHCP is occurring.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: mac
          type: keyword
          description: >
            Clients hardware address.
        - name: assigned_ip
          type: ip
          description: >
            Clients actual assigned IP address.
        - name: lease_time
          type: double
          description: >
            IP address lease interval.
        - name: trans_id
          type: integer
          description: >
            A random number chosen by the client for this transaction.

- key: dnp3
  title: dnp3
  description: >
    DNP3 requests and replies
  fields:
    - name: dnp3
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time of the request.
        - name: uid
          type: text
          description: >
            Unique identifier for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: fc_request
          type: keyword
          description: >
            The name of the function message in the request.
        - name: fc_reply
          type: keyword
          description: >
            The name of the function message in the reply.
        - name: iin
          type: integer
          description: >
            The responses internal indication number.

- key: dns
  title: dns
  description: >
    DNS activity
  fields:
    - name: dns
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The earliest time at which a DNS protocol message over the associated connection is observed.
        - name: uid
          type: text
          description: >
            A unique identifier of the connection over which DNS messages are being transferred.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: proto
          type: keyword
          description: >
            The transport layer protocol of the connection.
        - name: trans_id
          type: integer
          description: >
            A 16-bit identifier assigned by the program that generated the DNS query.  Also used in responses to match up replies to outstanding queries.
        - name: rtt
          type: double
          description: >
            Round trip time for the query and response. This indicates the delay between when the request was seen until the answer started.
        - name: query
          type: keyword
          description: >
            The domain name that is the subject of the DNS query.
        - name: qclass
          type: integer
          description: >
            The QCLASS value specifying the class of the query.
        - name: qclass_name
          type: keyword
          description: >
            A descriptive name for the class of the query.
        - name: qtype
          type: integer
          description: >
            A QTYPE value specifying the type of the query.
        - name: qtype_name
          type: keyword
          description: >
            A descriptive name for the type of the query.
        - name: rcode
          type: integer
          description: >
            The response code value in DNS response messages.
        - name: rcode_name
          type: keyword
          description: >
            A descriptive name for the response code value.
        - name: AA
          type: boolean
          description: >
            The Authoritative Answer bit for response messages specifies that the responding name server is an authority for the domain name in the question section.
        - name: TC
          type: boolean
          description: >
            The Truncation bit specifies that the message was truncated.
        - name: RD
          type: boolean
          description: >
            The Recursion Desired bit in a request message indicates that the client wants recursive service for this query.
        - name: RA
          type: boolean
          description: >
            The Recursion Available bit in a response message indicates that the name server supports recursive queries.
        - name: Z
          type: integer
          description: >
            A reserved field that is usually zero in queries and responses.
        - name: answers
          description: >
            The set of resource descriptions in the query answer.
        - name: TTLs
          description: >
            The caching intervals of the associated RRs described by the answers field.
        - name: rejected
          type: boolean
          description: >
            The DNS query was rejected by the server.
        - name: total_answers
          type: integer
          description: >
            The total number of resource records in a reply messages answer section.
        - name: total_replies
          type: integer
          description: >
            The total number of resource records in a reply messages answer, authority, and additional sections.
        - name: saw_query
          type: boolean
          description: >
            Whether the full DNS query has been seen.
        - name: saw_reply
          type: boolean
          description: >
            Whether the full DNS reply has been seen.
        - name: auth
          description: >
            (present if policy/protocols/dns/auth-addl.bro is loaded)
        - name: addl
          description: >
            (present if policy/protocols/dns/auth-addl.bro is loaded)

- key: dpd
  title: dpd
  description: >
    Dynamic protocol detection failures
  fields:
    - name: dpd
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when protocol analysis failed.
        - name: uid
          type: text
          description: >
            Connection unique ID.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: proto
          type: keyword
          description: >
            Transport protocol for the violation.
        - name: analyzer
          type: keyword
          description: >
            The analyzer that generated the violation.
        - name: failure_reason
          type: keyword
          description: >
            The textual reason for the analysis failure.
        - name: disabled_aids
          description: >
            Disabled analyzer IDs.  This is only for internal tracking so as to not attempt to disable analyzers multiple times.
        - name: packet_segment
          type: keyword
          description: >
            (present if policy/frameworks/dpd/packet-segment-logging.bro is loaded)

- key: files
  title: files
  description: >
    File analysis results
  fields:
    - name: files
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time when the file was first seen.
        - name: fuid
          type: text
          description: >
            An identifier associated with a single file.
        - name: tx_hosts
          description: >
            If this file was transferred over a network connection this should show the host or hosts that the data sourced from.
        - name: rx_hosts
          description: >
            If this file was transferred over a network connection this should show the host or hosts that the data traveled to.
        - name: conn_uids
          type: text
          description: >
            Connection UIDs over which the file was transferred.
        - name: source
          type: keyword
          description: >
            An identification of the source of the file data.  E.g. it may be a network protocol over which it was transferred, or a local file path which was read, or some other input source.
        - name: depth
          type: integer
          description: >
            A value to represent the depth of this file in relation to its source.  In SMTP, it is the depth of the MIME attachment on the message.  In HTTP, it is the depth of the request within the TCP connection.
        - name: analyzers
          description: >
            A set of analysis types done during the file analysis.
        - name: mime_type
          type: keyword
          description: >
            A mime type provided by the strongest file magic signature match against the bof_buffer field of fa_file, or in the cases where no buffering of the beginning of file occurs, an initial guess of the mime type based on the first data seen.
        - name: filename
          type: keyword
          description: >
            A filename for the file if one is available from the source for the file.  These will frequently come from Content-Disposition headers in network protocols.
        - name: duration
          type: double
          description: >
            The duration the file was analyzed for.
        - name: local_orig
          type: boolean
          description: >
            If the source of this file is a network connection, this field indicates if the data originated from the local network or not as determined by the configured Site::local_nets.
        - name: is_orig
          type: boolean
          description: >
            If the source of this file is a network connection, this field indicates if the file is being sent by the originator of the connection or the responder.
        - name: seen_bytes
          type: integer
          description: >
            Number of bytes provided to the file analysis engine for the file.
        - name: total_bytes
          type: integer
          description: >
            Total number of bytes that are supposed to comprise the full file.
        - name: missing_bytes
          type: integer
          description: >
            The number of bytes in the file stream that were completely missed during the process of analysis e.g. due to dropped packets.
        - name: overflow_bytes
          type: integer
          description: >
            The number of bytes in the file stream that were not delivered to stream file analyzers.  This could be overlapping bytes or bytes that couldnt be reassembled.
        - name: timedout
          type: boolean
          description: >
            Whether the file analysis timed out at least once for the file.
        - name: parent_fuid
          type: text
          description: >
            Identifier associated with a container file from which this one was extracted as part of the file analysis.
        - name: md5
          type: keyword
          description: >
            (present if base/files/hash/main.bro is loaded)
        - name: sha1
          type: keyword
          description: >
            (present if base/files/hash/main.bro is loaded)
        - name: sha256
          type: keyword
          description: >
            (present if base/files/hash/main.bro is loaded)
        - name: x509
          description: >
            (present if base/files/x509/main.bro is loaded)
        - name: extracted
          type: keyword
          description: >
            (present if base/files/extract/main.bro is loaded)
        - name: entropy
          type: double
          description: >
            (present if policy/frameworks/files/entropy-test-all-files.bro is loaded)

- key: ftp
  title: ftp
  description: >
    FTP activity
  fields:
    - name: ftp
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the command was sent.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: user
          type: keyword
          description: >
            User name for the current FTP session.
        - name: password
          type: keyword
          description: >
            Password for the current FTP session if captured.
        - name: command
          type: keyword
          description: >
            Command given by the client.
        - name: arg
          type: keyword
          description: >
            Argument for the command if one is given.
        - name: mime_type
          type: keyword
          description: >
            Libmagic sniffed file type if the command indicates a file transfer.
        - name: file_size
          type: integer
          description: >
            Size of the file if the command indicates a file transfer.
        - name: reply_code
          type: integer
          description: >
            Reply code from the server in response to the command.
        - name: reply_msg
          type: keyword
          description: >
            Reply message from the server in response to the command.
        - name: data_channel
          description: >
            Expected FTP data channel.
        - name: cwd
          type: keyword
          description: >
            Current working directory that this session is in.  By making the default value ., we can indicate that unless something more concrete is discovered that the existing but unknown directory is ok to use.
        - name: cmdarg
          description: >
            Command that is currently waiting for a response.
        - name: pending_commands
          description: >
            Queue for commands that have been sent but not yet responded to are tracked here.
        - name: passive
          type: boolean
          description: >
            Indicates if the session is in active or passive mode.
        - name: capture_password
          type: boolean
          description: >
            Determines if the password will be captured for this request.
        - name: fuid
          type: text
          description: >
            (present if base/protocols/ftp/files.bro is loaded)
        - name: last_auth_requested
          type: keyword
          description: >
            (present if base/protocols/ftp/gridftp.bro is loaded)

- key: http
  title: http
  description: >
    HTTP requests and replies
  fields:
    - name: http
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the request happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: trans_depth
          type: integer
          description: >
            Represents the pipelined depth into the connection of this request/response transaction.
        - name: method
          type: keyword
          description: >
            Verb used in the HTTP request (GET, POST, HEAD, etc.).
        - name: host
          type: keyword
          description: >
            Value of the HOST header.
        - name: uri
          type: keyword
          description: >
            URI used in the request.
        - name: referrer
          type: keyword
          description: >
            Value of the referer header.  The comment is deliberately misspelled like the standard declares, but the name used here is referrer spelled correctly.
        - name: version
          type: keyword
          description: >
            Value of the version portion of the request.
        - name: user_agent
          type: keyword
          description: >
            Value of the User-Agent header from the client.
        - name: request_body_len
          type: integer
          description: >
            Actual uncompressed content size of the data transferred from the client.
        - name: response_body_len
          type: integer
          description: >
            Actual uncompressed content size of the data transferred from the server.
        - name: status_code
          type: integer
          description: >
            Status code returned by the server.
        - name: status_msg
          type: keyword
          description: >
            Status message returned by the server.
        - name: info_code
          type: integer
          description: >
            Last seen 1xx informational reply code returned by the server.
        - name: info_msg
          type: keyword
          description: >
            Last seen 1xx informational reply message returned by the server.
        - name: tags
          description: >
            A set of indicators of various attributes discovered and related to a particular request/response pair.
        - name: username
          type: keyword
          description: >
            Username if basic-auth is performed for the request.
        - name: password
          type: keyword
          description: >
            Password if basic-auth is performed for the request.
        - name: capture_password
          type: boolean
          description: >
            Determines if the password will be captured for this request.
        - name: proxied
          description: >
            All of the headers that may indicate if the request was proxied.
        - name: range_request
          type: boolean
          description: >
            Indicates if this request can assume 206 partial content in response.
        - name: orig_fuids
          type: text
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: orig_filenames
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: orig_mime_types
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: resp_fuids
          type: text
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: resp_filenames
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: resp_mime_types
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: current_entity
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: orig_mime_depth
          type: integer
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: resp_mime_depth
          type: integer
          description: >
            (present if base/protocols/http/entities.bro is loaded)
        - name: client_header_names
          description: >
            (present if policy/protocols/http/header-names.bro is loaded)
        - name: server_header_names
          description: >
            (present if policy/protocols/http/header-names.bro is loaded)
        - name: omniture
          type: boolean
          description: >
            (present if policy/protocols/http/software-browser-plugins.bro is loaded)
        - name: flash_version
          type: keyword
          description: >
            (present if policy/protocols/http/software-browser-plugins.bro is loaded)
        - name: cookie_vars
          description: >
            (present if policy/protocols/http/var-extraction-cookies.bro is loaded)
        - name: uri_vars
          description: >
            (present if policy/protocols/http/var-extraction-uri.bro is loaded)

- key: intel
  title: intel
  description: >
    Intelligence data matches
  fields:
    - name: intel
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp when the data was discovered.
        - name: uid
          type: text
          description: >
            If a connection was associated with this intelligence hit, this is the uid for the connection
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: seen
          description: >
            Where the data was seen.
        - name: matched
          description: >
            Which indicator types matched.
        - name: sources
          description: >
            Sources which supplied data that resulted in this match.
        - name: fuid
          type: text
          description: >
            (present if base/frameworks/intel/files.bro is loaded)
        - name: file_mime_type
          type: keyword
          description: >
            (present if base/frameworks/intel/files.bro is loaded)
        - name: file_desc
          type: keyword
          description: >
            (present if base/frameworks/intel/files.bro is loaded)

- key: irc
  title: irc
  description: >
    IRC commands and responses
  fields:
    - name: irc
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp when the command was seen.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: nick
          type: keyword
          description: >
            Nickname given for the connection.
        - name: user
          type: keyword
          description: >
            Username given for the connection.
        - name: command
          type: keyword
          description: >
            Command given by the client.
        - name: value
          type: keyword
          description: >
            Value for the command given by the client.
        - name: addl
          type: keyword
          description: >
            Any additional data for the command.
        - name: dcc_file_name
          type: keyword
          description: >
            (present if base/protocols/irc/dcc-send.bro is loaded)
        - name: dcc_file_size
          type: integer
          description: >
            (present if base/protocols/irc/dcc-send.bro is loaded)
        - name: dcc_mime_type
          type: keyword
          description: >
            (present if base/protocols/irc/dcc-send.bro is loaded)
        - name: fuid
          type: text
          description: >
            (present if base/protocols/irc/files.bro is loaded)

- key: kerberos
  title: kerberos
  description: >
    Kerberos
  fields:
    - name: kerberos
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: request_type
          type: keyword
          description: >
            Request type - Authentication Service (AS) or Ticket Granting Service (TGS)
        - name: client
          type: keyword
          description: >
            Client
        - name: service
          type: keyword
          description: >
            Service
        - name: success
          type: boolean
          description: >
            Request result
        - name: error_code
          type: integer
          description: >
            Error code
        - name: error_msg
          type: keyword
          description: >
            Error message
        - name: from
          type: double
          description: >
            Ticket valid from
        - name: till
          type: double
          description: >
            Ticket valid till
        - name: cipher
          type: keyword
          description: >
            Ticket encryption type
        - name: forwardable
          type: boolean
          description: >
            Forwardable ticket requested
        - name: renewable
          type: boolean
          description: >
            Renewable ticket requested
        - name: logged
          type: boolean
          description: >
            Weve already logged this
        - name: client_cert
          description: >
            (present if base/protocols/krb/files.bro is loaded)
        - name: client_cert_subject
          type: keyword
          description: >
            (present if base/protocols/krb/files.bro is loaded)
        - name: client_cert_fuid
          type: text
          description: >
            (present if base/protocols/krb/files.bro is loaded)
        - name: server_cert
          description: >
            (present if base/protocols/krb/files.bro is loaded)
        - name: server_cert_subject
          type: keyword
          description: >
            (present if base/protocols/krb/files.bro is loaded)
        - name: server_cert_fuid
          type: text
          description: >
            (present if base/protocols/krb/files.bro is loaded)

- key: known_certs
  title: known_certs
  description: >
    SSL certificates
  fields:
    - name: known_certs
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The timestamp when the certificate was detected.
        - name: host
          type: ip
          description: >
            The address that offered the certificate.
        - name: port_num
          type: integer
          description: >
            If the certificate was handed out by a server, this is the port that the server was listening on.
        - name: subject
          type: keyword
          description: >
            Certificate subject.
        - name: issuer_subject
          type: keyword
          description: >
            Certificate issuer subject.
        - name: serial
          type: keyword
          description: >
            Serial number for the certificate.

- key: known_devices
  title: known_devices
  description: >
    MAC addresses of devices on the network
  fields:
    - name: known_devices
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The timestamp at which the host was detected.
        - name: mac
          type: keyword
          description: >
            The MAC address that was detected.
        - name: dhcp_host_name
          type: keyword
          description: >
            (present if policy/protocols/dhcp/known-devices-and-hostnames.bro is loaded)

- key: known_hosts
  title: known_hosts
  description: >
    Hosts that have completed TCP handshakes
  fields:
    - name: known_hosts
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The timestamp at which the host was detected.
        - name: host
          type: ip
          description: >
            The address that was detected originating or responding to a TCP connection.

- key: known_modbus
  title: known_modbus
  description: >
    Modbus masters and slaves
  fields:
    - name: known_modbus
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time the device was discovered.
        - name: host
          type: ip
          description: >
            The IP address of the host.
        - name: device_type
          description: >
            The type of device being tracked.

- key: known_services
  title: known_services
  description: >
    Services running on hosts
  fields:
    - name: known_services
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time at which the service was detected.
        - name: host
          type: ip
          description: >
            The host address on which the service is running.
        - name: port_num
          type: integer
          description: >
            The port number on which the service is running.
        - name: port_proto
          type: keyword
          description: >
            The transport-layer protocol which the service uses.
        - name: service
          description: >
            A set of protocols that match the services connection payloads.

- key: loaded_scripts
  title: loaded_scripts
  description: >
    Shows all scripts loaded by Bro
  fields:
    - name: loaded_scripts
      type: group
      fields:
        - name: name
          type: keyword
          description: >
            Name of the script loaded potentially with spaces included before the file name to indicate load depth.  The convention is two spaces per level of depth.

- key: modbus
  title: modbus
  description: >
    Modbus commands and responses
  fields:
    - name: modbus
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time of the request.
        - name: uid
          type: text
          description: >
            Unique identifier for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: func
          type: keyword
          description: >
            The name of the function message that was sent.
        - name: exception
          type: keyword
          description: >
            The exception if the response was a failure.
        - name: track_address
          type: integer
          description: >
            (present if policy/protocols/modbus/track-memmap.bro is loaded)

- key: modbus_register_change
  title: modbus_register_change
  description: >
    Tracks changes to Modbus holding registers
  fields:
    - name: modbus_register_change
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for the detected register change.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: register
          type: integer
          description: >
            The device memory offset.
        - name: old_val
          type: integer
          description: >
            The old value stored in the register.
        - name: new_val
          type: integer
          description: >
            The new value stored in the register.
        - name: delta
          type: double
          description: >
            The time delta between when the old_val and new_val were seen.

- key: mysql
  title: mysql
  description: >
    MySQL
  fields:
    - name: mysql
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: cmd
          type: keyword
          description: >
            The command that was issued
        - name: arg
          type: keyword
          description: >
            The argument issued to the command
        - name: success
          type: boolean
          description: >
            Did the server tell us that the command succeeded?
        - name: rows
          type: integer
          description: >
            The number of affected rows, if any
        - name: response
          type: keyword
          description: >
            Server message, if any

- key: netcontrol
  title: netcontrol
  description: >
    NetControl actions
  fields:
    - name: netcontrol
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time at which the recorded activity occurred.
        - name: rule_id
          type: keyword
          description: >
            ID of the rule; unique during each Bro run.
        - name: category
          description: >
            Type of the log entry.
        - name: cmd
          type: keyword
          description: >
            The command the log entry is about.
        - name: state
          description: >
            State the log entry reflects.
        - name: action
          type: keyword
          description: >
            String describing an action the entry is about.
        - name: target
          description: >
            The target type of the action.
        - name: entity_type
          type: keyword
          description: >
            Type of the entity the log entry is about.
        - name: entity
          type: keyword
          description: >
            String describing the entity the log entry is about.
        - name: mod
          type: keyword
          description: >
            String describing the optional modification of the entry (e.h. redirect)
        - name: msg
          type: keyword
          description: >
            String with an additional message.
        - name: priority
          type: integer
          description: >
            Number describing the priority of the log entry.
        - name: expire
          type: double
          description: >
            Expiry time of the log entry.
        - name: location
          type: keyword
          description: >
            Location where the underlying action was triggered.
        - name: plugin
          type: keyword
          description: >
            Plugin triggering the log entry.

- key: netcontrol_catch_release
  title: netcontrol_catch_release
  description: >
    NetControl catch and release actions
  fields:
    - name: netcontrol_catch_release
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The absolute time indicating when the action for this log-line occured.
        - name: rule_id
          type: keyword
          description: >
            The rule id that this log line refers to.
        - name: ip
          type: ip
          description: >
            The IP address that this line refers to.
        - name: action
          description: >
            The action that was taken in this log-line.
        - name: block_interval
          type: double
          description: >
            The current block_interaval (for how long the address is blocked).
        - name: watch_interval
          type: double
          description: >
            The current watch_interval (for how long the address will be watched and re-block if it reappears).
        - name: blocked_until
          type: double
          description: >
            The absolute time until which the address is blocked.
        - name: watched_until
          type: double
          description: >
            The absolute time until which the address will be monitored.
        - name: num_blocked
          type: integer
          description: >
            Number of times that this address was blocked in the current cycle.
        - name: location
          type: keyword
          description: >
            The user specified location string.
        - name: message
          type: keyword
          description: >
            Additional informational string by the catch and release framework about this log-line.

- key: netcontrol_drop
  title: netcontrol_drop
  description: >
    NetControl actions
  fields:
    - name: netcontrol_drop
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time at which the recorded activity occurred.
        - name: rule_id
          type: keyword
          description: >
            ID of the rule; unique during each Bro run.
        - name: orig_h
          type: ip
          description: >
            The originators IP address.
        - name: orig_p
          type: integer
          description: >
            The originators port number.
        - name: resp_h
          type: ip
          description: >
            The responders IP address.
        - name: resp_p
          type: integer
          description: >
            The responders port number.
        - name: expire
          type: double
          description: >
            Expiry time of the shunt.
        - name: location
          type: keyword
          description: >
            Location where the underlying action was triggered.

- key: netcontrol_shunt
  title: netcontrol_shunt
  description: >
    NetControl shunt actions
  fields:
    - name: netcontrol_shunt
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time at which the recorded activity occurred.
        - name: rule_id
          type: keyword
          description: >
            ID of the rule; unique during each Bro run.
        - name: f
          description: >
            Flow ID of the shunted flow.
        - name: expire
          type: double
          description: >
            Expiry time of the shunt.
        - name: location
          type: keyword
          description: >
            Location where the underlying action was triggered.

- key: notice
  title: notice
  description: >
    Bro notices
  fields:
    - name: notice
      type: group
      fields:
        - name: ts
          type: double
          description: >
            An absolute time indicating when the notice occurred, defaults to the current network time.
        - name: uid
          type: text
          description: >
            A connection UID which uniquely identifies the endpoints concerned with the notice.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: conn
          description: >
            A shorthand way of giving the uid and id to a notice.  The reference to the actual connection will be deleted after applying the notice policy.
        - name: iconn
          description: >
            A shorthand way of giving the uid and id to a notice.  The reference to the actual connection will be deleted after applying the notice policy.
        - name: f
          description: >
            A file record if the notice is related to a file.  The reference to the actual fa_file record will be deleted after applying the notice policy.
        - name: fuid
          type: text
          description: >
            A file unique ID if this notice is related to a file.  If the f field is provided, this will be automatically filled out.
        - name: file_mime_type
          type: keyword
          description: >
            A mime type if the notice is related to a file.  If the f field is provided, this will be automatically filled out.
        - name: file_desc
          type: keyword
          description: >
            Frequently files can be described to give a bit more context.  This field will typically be automatically filled out from an fa_file record.  For example, if a notice was related to a file over HTTP, the URL of the request would be shown.
        - name: proto
          type: keyword
          description: >
            The transport protocol. Filled automatically when either conn, iconn or p is specified.
        - name: note
          description: >
            The Notice::Type of the notice.
        - name: msg
          type: keyword
          description: >
            The human readable message for the notice.
        - name: sub
          type: keyword
          description: >
            The human readable sub-message.
        - name: src
          type: ip
          description: >
            Source address, if we dont have a conn_id.
        - name: dst
          type: ip
          description: >
            Destination address.
        - name: p
          type: integer
          description: >
            Associated port, if we dont have a conn_id.
        - name: n
          type: integer
          description: >
            Associated count, or perhaps a status code.
        - name: src_peer
          description: >
            Peer that raised this notice.
        - name: peer_descr
          type: keyword
          description: >
            Textual description for the peer that raised this notice.
        - name: actions
          description: >
            The actions which have been applied to this notice.
        - name: email_body_sections
          description: >
            By adding chunks of text into this element, other scripts can expand on notices that are being emailed.  The normal way to add text is to extend the vector by handling the Notice::notice event and modifying the notice in place.
        - name: email_delay_tokens
          description: >
            Adding a string token to this set will cause the notice frameworks built-in emailing functionality to delay sending the email until either the token has been removed or the email has been delayed for Notice::max_email_delay.
        - name: identifier
          type: keyword
          description: >
            This field is to be provided when a notice is generated for the purpose of deduplicating notices.  The identifier string should be unique for a single instance of the notice.  This field should be filled out in almost all cases when generating notices to define when a notice is conceptually a duplicate of a previous notice.
        - name: suppress_for
          type: double
          description: >
            This field indicates the length of time that this unique notice should be suppressed.
        - name: dropped
          type: boolean
          description: >
            (present if base/frameworks/notice/actions/drop.bro is loaded)
        - name: remote_location
          description: >
            (present if base/frameworks/notice/actions/add-geodata.bro is loaded)

- key: ntlm
  title: ntlm
  description: >
    NT LAN Manager (NTLM)
  fields:
    - name: ntlm
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: username
          type: keyword
          description: >
            Username given by the client.
        - name: hostname
          type: keyword
          description: >
            Hostname given by the client.
        - name: domainname
          type: keyword
          description: >
            Domainname given by the client.
        - name: success
          type: boolean
          description: >
            Indicate whether or not the authentication was successful.
        - name: status
          type: keyword
          description: >
            A string representation of the status code that was returned in response to the authentication attempt.
        - name: done
          type: boolean
          description: >
            Internally used field to indicate if the login attempt has already been logged.

- key: openflow
  title: openflow
  description: >
    OpenFlow debug log
  fields:
    - name: openflow
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Network time.
        - name: dpid
          type: integer
          description: >
            OpenFlow switch datapath id.
        - name: match
          description: >
            OpenFlow match fields.
        - name: flow_mod
          description: >
            OpenFlow modify flow entry message.

- key: packet_filter
  title: packet_filter
  description: >
    List packet filters that were applied
  fields:
    - name: packet_filter
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time at which the packet filter installation attempt was made.
        - name: node
          type: keyword
          description: >
            This is a string representation of the node that applied this packet filter.  Its mostly useful in the context of dynamically changing filters on clusters.
        - name: filter
          type: keyword
          description: >
            The packet filter that is being set.
        - name: init
          type: boolean
          description: >
            Indicate if this is the filter set during initialization.
        - name: success
          type: boolean
          description: >
            Indicate if the filter was applied successfully.

- key: pe
  title: pe
  description: >
    Portable Executable (PE)
  fields:
    - name: pe
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Current timestamp.
        - name: id
          type: keyword
          description: >
            File id of this portable executable file.
        - name: machine
          type: keyword
          description: >
            The target machine that the file was compiled for.
        - name: compile_ts
          type: double
          description: >
            The time that the file was created at.
        - name: os
          type: keyword
          description: >
            The required operating system.
        - name: subsystem
          type: keyword
          description: >
            The subsystem that is required to run this file.
        - name: is_exe
          type: boolean
          description: >
            Is the file an executable, or just an object file?
        - name: is_64bit
          type: boolean
          description: >
            Is the file a 64-bit executable?
        - name: uses_aslr
          type: boolean
          description: >
            Does the file support Address Space Layout Randomization?
        - name: uses_dep
          type: boolean
          description: >
            Does the file support Data Execution Prevention?
        - name: uses_code_integrity
          type: boolean
          description: >
            Does the file enforce code integrity checks?
        - name: uses_seh
          type: boolean
          description: >
            Does the file use structured exception handing?
        - name: has_import_table
          type: boolean
          description: >
            Does the file have an import table?
        - name: has_export_table
          type: boolean
          description: >
            Does the file have an export table?
        - name: has_cert_table
          type: boolean
          description: >
            Does the file have an attribute certificate table?
        - name: has_debug_data
          type: boolean
          description: >
            Does the file have a debug table?
        - name: section_names
          description: >
            The names of the sections, in order.

- key: radius
  title: radius
  description: >
    RADIUS authentication attempts
  fields:
    - name: radius
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: username
          type: keyword
          description: >
            The username, if present.
        - name: mac
          type: keyword
          description: >
            MAC address, if present.
        - name: remote_ip
          type: ip
          description: >
            Remote IP address, if present.
        - name: connect_info
          type: keyword
          description: >
            Connect info, if present.
        - name: result
          type: keyword
          description: >
            Successful or failed authentication.
        - name: logged
          type: boolean
          description: >
            Whether this has already been logged and can be ignored.

- key: rdp
  title: rdp
  description: >
    RDP
  fields:
    - name: rdp
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: cookie
          type: keyword
          description: >
            Cookie value used by the client machine. This is typically a username.
        - name: result
          type: keyword
          description: >
            Status result for the connection.  Its a mix between RDP negotation failure messages and GCC server create response messages.
        - name: security_protocol
          type: keyword
          description: >
            Security protocol chosen by the server.
        - name: keyboard_layout
          type: keyword
          description: >
            Keyboard layout (language) of the client machine.
        - name: client_build
          type: keyword
          description: >
            RDP client version used by the client machine.
        - name: client_name
          type: keyword
          description: >
            Name of the client machine.
        - name: client_dig_product_id
          type: keyword
          description: >
            Product ID of the client machine.
        - name: desktop_width
          type: integer
          description: >
            Desktop width of the client machine.
        - name: desktop_height
          type: integer
          description: >
            Desktop height of the client machine.
        - name: requested_color_depth
          type: keyword
          description: >
            The color depth requested by the client in the high_color_depth field.
        - name: cert_type
          type: keyword
          description: >
            If the connection is being encrypted with native RDP encryption, this is the type of cert being used.
        - name: cert_count
          type: integer
          description: >
            The number of certs seen.  X.509 can transfer an entire certificate chain.
        - name: cert_permanent
          type: boolean
          description: >
            Indicates if the provided certificate or certificate chain is permanent or temporary.
        - name: encryption_level
          type: keyword
          description: >
            Encryption level of the connection.
        - name: encryption_method
          type: keyword
          description: >
            Encryption method of the connection.
        - name: analyzer_id
          type: integer
          description: >
            The analyzer ID used for the analyzer instance attached to each connection.  It is not used for logging since its a meaningless arbitrary number.
        - name: done
          type: boolean
          description: >
            Track status of logging RDP connections.
        - name: ssl
          type: boolean
          description: >
            (present if policy/protocols/rdp/indicate_ssl.bro is loaded)

- key: reporter
  title: reporter
  description: >
    Internal error/warning/info messages
  fields:
    - name: reporter
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The network time at which the reporter event was generated.
        - name: level
          description: >
            The severity of the reporter message. Levels are INFO for informational messages, not needing specific attention; WARNING for warning of a potential problem, and ERROR for a non-fatal error that should be addressed, but doesnt terminate program execution.
        - name: message
          type: keyword
          description: >
            An info/warning/error message that could have either been generated from the internal Bro core or at the scripting-layer.
        - name: location
          type: keyword
          description: >
            This is the location in a Bro script where the message originated. Not all reporter messages will have locations in them though.

- key: rfb
  title: rfb
  description: >
    Remote Framebuffer (RFB)
  fields:
    - name: rfb
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the event happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: client_major_version
          type: keyword
          description: >
            Major version of the client.
        - name: client_minor_version
          type: keyword
          description: >
            Minor version of the client.
        - name: server_major_version
          type: keyword
          description: >
            Major version of the server.
        - name: server_minor_version
          type: keyword
          description: >
            Minor version of the server.
        - name: authentication_method
          type: keyword
          description: >
            Identifier of authentication method used.
        - name: auth
          type: boolean
          description: >
            Whether or not authentication was successful.
        - name: share_flag
          type: boolean
          description: >
            Whether the client has an exclusive or a shared session.
        - name: desktop_name
          type: keyword
          description: >
            Name of the screen that is being shared.
        - name: width
          type: integer
          description: >
            Width of the screen that is being shared.
        - name: height
          type: integer
          description: >
            Height of the screen that is being shared.
        - name: done
          type: boolean
          description: >
            Internally used value to determine if this connection has already been logged.

- key: signatures
  title: signatures
  description: >
    Signature matches
  fields:
    - name: signatures
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The network time at which a signature matching type of event to be logged has occurred.
        - name: uid
          type: text
          description: >
            A unique identifier of the connection which triggered the signature match event.
        - name: src_addr
          type: ip
          description: >
            The host which triggered the signature match event.
        - name: src_port
          type: integer
          description: >
            The host port on which the signature-matching activity occurred.
        - name: dst_addr
          type: ip
          description: >
            The destination host which was sent the payload that triggered the signature match.
        - name: dst_port
          type: integer
          description: >
            The destination host port which was sent the payload that triggered the signature match.
        - name: note
          description: >
            Notice associated with signature event.
        - name: sig_id
          type: keyword
          description: >
            The name of the signature that matched.
        - name: event_msg
          type: keyword
          description: >
            A more descriptive message of the signature-matching event.
        - name: sub_msg
          type: keyword
          description: >
            Extracted payload data or extra message.
        - name: sig_count
          type: integer
          description: >
            Number of sigs, usually from summary count.
        - name: host_count
          type: integer
          description: >
            Number of hosts, from a summary count.

- key: sip
  title: sip
  description: >
    SIP
  fields:
    - name: sip
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for when the request happened.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: trans_depth
          type: integer
          description: >
            Represents the pipelined depth into the connection of this request/response transaction.
        - name: method
          type: keyword
          description: >
            Verb used in the SIP request (INVITE, REGISTER etc.).
        - name: uri
          type: keyword
          description: >
            URI used in the request.
        - name: date
          type: keyword
          description: >
            Contents of the Date: header from the client
        - name: request_from
          type: keyword
          description: >
            Contents of the request From: header Note: The tag= value thats usually appended to the sender is stripped off and not logged.
        - name: request_to
          type: keyword
          description: >
            Contents of the To: header
        - name: response_from
          type: keyword
          description: >
            Contents of the response From: header Note: The tag= value thats usually appended to the sender is stripped off and not logged.
        - name: response_to
          type: keyword
          description: >
            Contents of the response To: header
        - name: reply_to
          type: keyword
          description: >
            Contents of the Reply-To: header
        - name: call_id
          type: keyword
          description: >
            Contents of the Call-ID: header from the client
        - name: seq
          type: keyword
          description: >
            Contents of the CSeq: header from the client
        - name: subject
          type: keyword
          description: >
            Contents of the Subject: header from the client
        - name: request_path
          description: >
            The client message transmission path, as extracted from the headers.
        - name: response_path
          description: >
            The server message transmission path, as extracted from the headers.
        - name: user_agent
          type: keyword
          description: >
            Contents of the User-Agent: header from the client
        - name: status_code
          type: integer
          description: >
            Status code returned by the server.
        - name: status_msg
          type: keyword
          description: >
            Status message returned by the server.
        - name: warning
          type: keyword
          description: >
            Contents of the Warning: header
        - name: request_body_len
          type: integer
          description: >
            Contents of the Content-Length: header from the client
        - name: response_body_len
          type: integer
          description: >
            Contents of the Content-Length: header from the server
        - name: content_type
          type: keyword
          description: >
            Contents of the Content-Type: header from the server

- key: smb_cmd
  title: smb_cmd
  description: >
    SMB commands
  fields:
    - name: smb_cmd
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp of the command request.
        - name: uid
          type: text
          description: >
            Unique ID of the connection the request was sent over.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: command
          type: keyword
          description: >
            The command sent by the client.
        - name: sub_command
          type: keyword
          description: >
            The subcommand sent by the client, if present.
        - name: argument
          type: keyword
          description: >
            Command argument sent by the client, if any.
        - name: status
          type: keyword
          description: >
            Server reply to the clients command.
        - name: rtt
          type: double
          description: >
            Round trip time from the request to the response.
        - name: version
          type: keyword
          description: >
            Version of SMB for the command.
        - name: username
          type: keyword
          description: >
            Authenticated username, if available.
        - name: tree
          type: keyword
          description: >
            If this is related to a tree, this is the tree that was used for the current command.
        - name: tree_service
          type: keyword
          description: >
            The type of tree (disk share, printer share, named pipe, etc.).
        - name: referenced_file
          description: >
            If the command referenced a file, store it here.
        - name: referenced_tree
          description: >
            If the command referenced a tree, store it here.
        - name: smb1_offered_dialects
          description: >
            (present if policy/protocols/smb/smb1-main.bro is loaded)
        - name: smb2_offered_dialects
          description: >
            (present if policy/protocols/smb/smb2-main.bro is loaded)

- key: smb_files
  title: smb_files
  description: >
    SMB files
  fields:
    - name: smb_files
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the file was first discovered.
        - name: uid
          type: text
          description: >
            Unique ID of the connection the file was sent over.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: fuid
          type: text
          description: >
            Unique ID of the file.
        - name: action
          description: >
            Action this log record represents.
        - name: path
          type: keyword
          description: >
            Path pulled from the tree this file was transferred to or from.
        - name: name
          type: keyword
          description: >
            Filename if one was seen.
        - name: size
          type: integer
          description: >
            Total size of the file.
        - name: prev_name
          type: keyword
          description: >
            If the rename action was seen, this will be the files previous name.
        - name: times
          description: >
            Last time this file was modified.
        - name: fid
          type: integer
          description: >
            ID referencing this file.
        - name: uuid
          type: text
          description: >
            UUID referencing this file if DCE/RPC.

- key: smb_mapping
  title: smb_mapping
  description: >
    SMB trees
  fields:
    - name: smb_mapping
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the tree was mapped.
        - name: uid
          type: text
          description: >
            Unique ID of the connection the tree was mapped over.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: path
          type: keyword
          description: >
            Name of the tree path.
        - name: service
          type: keyword
          description: >
            The type of resource of the tree (disk share, printer share, named pipe, etc.).
        - name: native_file_system
          type: keyword
          description: >
            File system of the tree.
        - name: share_type
          type: keyword
          description: >
            If this is SMB2, a share type will be included.  For SMB1, the type of share will be deduced and included as well.

- key: smtp
  title: smtp
  description: >
    SMTP transactions
  fields:
    - name: smtp
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the message was first seen.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: trans_depth
          type: integer
          description: >
            A count to represent the depth of this message transaction in a single connection where multiple messages were transferred.
        - name: helo
          type: keyword
          description: >
            Contents of the Helo header.
        - name: mailfrom
          type: keyword
          description: >
            Email addresses found in the From header.
        - name: rcptto
          description: >
            Email addresses found in the Rcpt header.
        - name: date
          type: keyword
          description: >
            Contents of the Date header.
        - name: from
          type: keyword
          description: >
            Contents of the From header.
        - name: to
          description: >
            Contents of the To header.
        - name: cc
          description: >
            Contents of the CC header.
        - name: reply_to
          type: keyword
          description: >
            Contents of the ReplyTo header.
        - name: msg_id
          type: keyword
          description: >
            Contents of the MsgID header.
        - name: in_reply_to
          type: keyword
          description: >
            Contents of the In-Reply-To header.
        - name: subject
          type: keyword
          description: >
            Contents of the Subject header.
        - name: x_originating_ip
          type: ip
          description: >
            Contents of the X-Originating-IP header.
        - name: first_received
          type: keyword
          description: >
            Contents of the first Received header.
        - name: second_received
          type: keyword
          description: >
            Contents of the second Received header.
        - name: last_reply
          type: keyword
          description: >
            The last message that the server sent to the client.
        - name: path
          description: >
            The message transmission path, as extracted from the headers.
        - name: user_agent
          type: keyword
          description: >
            Value of the User-Agent header from the client.
        - name: tls
          type: boolean
          description: >
            Indicates that the connection has switched to using TLS.
        - name: process_received_from
          type: boolean
          description: >
            Indicates if the Received: from headers should still be processed.
        - name: has_client_activity
          type: boolean
          description: >
            Indicates if client activity has been seen, but not yet logged.
        - name: entity
          description: >
            (present if base/protocols/smtp/entities.bro is loaded)
        - name: fuids
          type: text
          description: >
            (present if base/protocols/smtp/files.bro is loaded)
        - name: is_webmail
          type: boolean
          description: >
            (present if policy/protocols/smtp/software.bro is loaded)

- key: snmp
  title: snmp
  description: >
    SNMP messages
  fields:
    - name: snmp
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp of first packet belonging to the SNMP session.
        - name: uid
          type: text
          description: >
            The unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: duration
          type: double
          description: >
            The amount of time between the first packet beloning to the SNMP session and the latest one seen.
        - name: version
          type: keyword
          description: >
            The version of SNMP being used.
        - name: community
          type: keyword
          description: >
            The community string of the first SNMP packet associated with the session.  This is used as part of SNMPs (v1 and v2c) administrative/security framework.  See RFC 1157 or RFC 1901.
        - name: get_requests
          type: integer
          description: >
            The number of variable bindings in GetRequest/GetNextRequest PDUs seen for the session.
        - name: get_bulk_requests
          type: integer
          description: >
            The number of variable bindings in GetBulkRequest PDUs seen for the session.
        - name: get_responses
          type: integer
          description: >
            The number of variable bindings in GetResponse/Response PDUs seen for the session.
        - name: set_requests
          type: integer
          description: >
            The number of variable bindings in SetRequest PDUs seen for the session.
        - name: display_string
          type: keyword
          description: >
            A system description of the SNMP responder endpoint.
        - name: up_since
          type: double
          description: >
            The time at which the SNMP responder endpoint claims its been up since.

- key: socks
  title: socks
  description: >
    SOCKS proxy requests
  fields:
    - name: socks
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the proxy connection was first detected.
        - name: uid
          type: text
          description: >
            Unique ID for the tunnel - may correspond to connection uid or be non-existent.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: version
          type: integer
          description: >
            Protocol version of SOCKS.
        - name: user
          type: keyword
          description: >
            Username used to request a login to the proxy.
        - name: password
          type: keyword
          description: >
            Password used to request a login to the proxy.
        - name: status
          type: keyword
          description: >
            Server status for the attempt at using the proxy.
        - name: request
          description: >
            Client requested SOCKS address. Could be an address, a name or both.
        - name: request_p
          type: integer
          description: >
            Client requested port.
        - name: bound
          description: >
            Server bound address. Could be an address, a name or both.
        - name: bound_p
          type: integer
          description: >
            Server bound port.

- key: software
  title: software
  description: >
    Software being used on the network
  fields:
    - name: software
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time at which the software was detected.
        - name: host
          type: ip
          description: >
            The IP address detected running the software.
        - name: host_p
          type: integer
          description: >
            The port on which the software is running. Only sensible for server software.
        - name: software_type
          description: >
            The type of software detected (e.g. HTTP::SERVER).
        - name: name
          type: keyword
          description: >
            Name of the software (e.g. Apache).
        - name: version
          description: >
            Version of the software.
        - name: unparsed_version
          type: keyword
          description: >
            The full unparsed version string found because the version parsing doesnt always work reliably in all cases and this acts as a fallback in the logs.
        - name: force_log
          type: boolean
          description: >
            This can indicate that this software being detected should definitely be sent onward to the logging framework.  By default, only software that is interesting due to a change in version or it being currently unknown is sent to the logging framework.  This can be set to T to force the record to be sent to the logging framework if some amount of this tracking needs to happen in a specific way to the software.
        - name: url
          type: keyword
          description: >
            (present if policy/protocols/http/detect-webapps.bro is loaded)

- key: ssh
  title: ssh
  description: >
    SSH connections
  fields:
    - name: ssh
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the SSH connection began.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: version
          type: integer
          description: >
            SSH major version (1 or 2)
        - name: auth_success
          type: boolean
          description: >
            Authentication result (T=success, F=failure, unset=unknown)
        - name: auth_attempts
          type: integer
          description: >
            The number of authentication attemps we observed. Theres always at least one, since some servers might support no authentication at all. Its important to note that not all of these are failures, since some servers require two-factor auth (e.g. password AND pubkey)
        - name: direction
          description: >
            Direction of the connection. If the client was a local host logging into an external host, this would be OUTBOUND. INBOUND would be set for the opposite situation.
        - name: client
          type: keyword
          description: >
            The clients version string
        - name: server
          type: keyword
          description: >
            The servers version string
        - name: cipher_alg
          type: keyword
          description: >
            The encryption algorithm in use
        - name: mac_alg
          type: keyword
          description: >
            The signing (MAC) algorithm in use
        - name: compression_alg
          type: keyword
          description: >
            The compression algorithm in use
        - name: kex_alg
          type: keyword
          description: >
            The key exchange algorithm in use
        - name: host_key_alg
          type: keyword
          description: >
            The server host keys algorithm
        - name: host_key
          type: keyword
          description: >
            The servers key fingerprint

- key: ssl
  title: ssl
  description: >
    SSL/TLS handshake info
  fields:
    - name: ssl
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time when the SSL connection was first detected.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: version_num
          type: integer
          description: >
            Numeric SSL/TLS version that the server chose.
        - name: version
          type: keyword
          description: >
            SSL/TLS version that the server chose.
        - name: cipher
          type: keyword
          description: >
            SSL/TLS cipher suite that the server chose.
        - name: curve
          type: keyword
          description: >
            Elliptic curve the server chose when using ECDH/ECDHE.
        - name: server_name
          type: keyword
          description: >
            Value of the Server Name Indicator SSL/TLS extension.  It indicates the server name that the client was requesting.
        - name: session_id
          type: keyword
          description: >
            Session ID offered by the client for session resumption. Not used for logging.
        - name: resumed
          type: boolean
          description: >
            Flag to indicate if the session was resumed reusing the key material exchanged in an earlier connection.
        - name: client_ticket_empty_session_seen
          type: boolean
          description: >
            Flag to indicate if we saw a non-empty session ticket being sent by the client using an empty session ID. This value is used to determine if a session is being resumed. Its not logged.
        - name: client_key_exchange_seen
          type: boolean
          description: >
            Flag to indicate if we saw a client key exchange message sent by the client. This value is used to determine if a session is being resumed. Its not logged.
        - name: server_appdata
          type: integer
          description: >
            Count to track if the server already sent an application data packet for TLS 1.3. Used to track when a session was established.
        - name: client_appdata
          type: boolean
          description: >
            Flag to track if the client already sent an application data packet for TLS 1.3. Used to track when a session was established.
        - name: last_alert
          type: keyword
          description: >
            Last alert that was seen during the connection.
        - name: next_protocol
          type: keyword
          description: >
            Next protocol the server chose using the application layer next protocol extension, if present.
        - name: analyzer_id
          type: integer
          description: >
            The analyzer ID used for the analyzer instance attached to each connection.  It is not used for logging since its a meaningless arbitrary number.
        - name: established
          type: boolean
          description: >
            Flag to indicate if this ssl session has been established successfully, or if it was aborted during the handshake.
        - name: logged
          type: boolean
          description: >
            Flag to indicate if this record already has been logged, to prevent duplicates.

- key: stats
  title: stats
  description: >
    Memory/event/packet/lag statistics
  fields:
    - name: stats
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp for the measurement.
        - name: peer
          type: keyword
          description: >
            Peer that generated this log.  Mostly for clusters.
        - name: mem
          type: integer
          description: >
            Amount of memory currently in use in MB.
        - name: pkts_proc
          type: integer
          description: >
            Number of packets processed since the last stats interval.
        - name: bytes_recv
          type: integer
          description: >
            Number of bytes received since the last stats interval if reading live traffic.
        - name: pkts_dropped
          type: integer
          description: >
            Number of packets dropped since the last stats interval if reading live traffic.
        - name: pkts_link
          type: integer
          description: >
            Number of packets seen on the link since the last stats interval if reading live traffic.
        - name: pkt_lag
          type: double
          description: >
            Lag between the wall clock and packet timestamps if reading live traffic.
        - name: events_proc
          type: integer
          description: >
            Number of events processed since the last stats interval.
        - name: events_queued
          type: integer
          description: >
            Number of events that have been queued since the last stats interval.
        - name: active_tcp_conns
          type: integer
          description: >
            TCP connections currently in memory.
        - name: active_udp_conns
          type: integer
          description: >
            UDP connections currently in memory.
        - name: active_icmp_conns
          type: integer
          description: >
            ICMP connections currently in memory.
        - name: tcp_conns
          type: integer
          description: >
            TCP connections seen since last stats interval.
        - name: udp_conns
          type: integer
          description: >
            UDP connections seen since last stats interval.
        - name: icmp_conns
          type: integer
          description: >
            ICMP connections seen since last stats interval.
        - name: timers
          type: integer
          description: >
            Number of timers scheduled since last stats interval.
        - name: active_timers
          type: integer
          description: >
            Current number of scheduled timers.
        - name: files
          type: integer
          description: >
            Number of files seen since last stats interval.
        - name: active_files
          type: integer
          description: >
            Current number of files actively being seen.
        - name: dns_requests
          type: integer
          description: >
            Number of DNS requests seen since last stats interval.
        - name: active_dns_requests
          type: integer
          description: >
            Current number of DNS requests awaiting a reply.
        - name: reassem_tcp_size
          type: integer
          description: >
            Current size of TCP data in reassembly.
        - name: reassem_file_size
          type: integer
          description: >
            Current size of File data in reassembly.
        - name: reassem_frag_size
          type: integer
          description: >
            Current size of packet fragment data in reassembly.
        - name: reassem_unknown_size
          type: integer
          description: >
            Current size of unknown data in reassembly (this is only PIA buffer right now).

- key: syslog
  title: syslog
  description: >
    Syslog messages
  fields:
    - name: syslog
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp when the syslog message was seen.
        - name: uid
          type: text
          description: >
            Unique ID for the connection.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: proto
          type: keyword
          description: >
            Protocol over which the message was seen.
        - name: facility
          type: keyword
          description: >
            Syslog facility for the message.
        - name: severity
          type: keyword
          description: >
            Syslog severity for the message.
        - name: message
          type: keyword
          description: >
            The plain text message.

- key: traceroute
  title: traceroute
  description: >
    Traceroute detection
  fields:
    - name: traceroute
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp
        - name: src
          type: ip
          description: >
            Address initiating the traceroute.
        - name: dst
          type: ip
          description: >
            Destination address of the traceroute.
        - name: proto
          type: keyword
          description: >
            Protocol used for the traceroute.

- key: tunnel
  title: tunnel
  description: >
    Tunneling protocol events
  fields:
    - name: tunnel
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Time at which some tunnel activity occurred.
        - name: uid
          type: text
          description: >
            The unique identifier for the tunnel, which may correspond to a connections uid field for non-IP-in-IP tunnels. This is optional because there could be numerous connections for payload proxies like SOCKS but we should treat it as a single tunnel.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: tunnel_type
          description: >
            The type of tunnel.
        - name: action
          description: >
            The type of activity that occurred.

- key: unified2
  title: unified2
  description: >
    Interprets Snorts unified output
  fields:
    - name: unified2
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Timestamp attached to the alert.
        - name: id
          description: >
            Addresses and ports for the connection.
        - name: sensor_id
          type: integer
          description: >
            Sensor that originated this event.
        - name: signature_id
          type: integer
          description: >
            Sig id for this generator.
        - name: signature
          type: keyword
          description: >
            A string representation of the signature_id field if a sid_msg.map file was loaded.
        - name: generator_id
          type: integer
          description: >
            Which generator generated the alert?
        - name: generator
          type: keyword
          description: >
            A string representation of the generator_id field if a gen_msg.map file was loaded.
        - name: signature_revision
          type: integer
          description: >
            Sig revision for this id.
        - name: classification_id
          type: integer
          description: >
            Event classification.
        - name: classification
          type: keyword
          description: >
            Descriptive classification string.
        - name: priority_id
          type: integer
          description: >
            Event priority.
        - name: event_id
          type: integer
          description: >
            Event ID.
        - name: packet
          type: keyword
          description: >
            Some of the packet data.

- key: weird
  title: weird
  description: >
    Unexpected network-level activity
  fields:
    - name: weird
      type: group
      fields:
        - name: ts
          type: double
          description: >
            The time when the weird occurred.
        - name: uid
          type: text
          description: >
            If a connection is associated with this weird, this will be the connections unique ID.
        - name: id.orig_h
          type: ip
          description: >
            The originators IP address.
        - name: id.orig_p
          type: integer
          description: >
            The originators port number.
        - name: id.resp_h
          type: ip
          description: >
            The responders IP address.
        - name: id.resp_p
          type: integer
          description: >
            The responders port number.
        - name: conn
          description: >
            A shorthand way of giving the uid and id to a weird.
        - name: name
          type: keyword
          description: >
            The name of the weird that occurred.
        - name: addl
          type: keyword
          description: >
            Additional information accompanying the weird if any.
        - name: notice
          type: boolean
          description: >
            Indicate if this weird was also turned into a notice.
        - name: peer
          type: keyword
          description: >
            The peer that originated this weird.  This is helpful in cluster deployments if a particular cluster node is having trouble to help identify which node is having trouble.
        - name: identifier
          type: keyword
          description: >
            This field is to be provided when a weird is generated for the purpose of deduplicating weirds. The identifier string should be unique for a single instance of the weird. This field is used to define when a weird is conceptually a duplicate of a previous weird.

- key: x509
  title: x509
  description: >
    X.509 certificate info
  fields:
    - name: x509
      type: group
      fields:
        - name: ts
          type: double
          description: >
            Current timestamp.
        - name: id
          type: keyword
          description: >
            File id of this certificate.
        - name: certificate
          description: >
            Basic information about the certificate.
        - name: handle
          description: >
            The opaque wrapping the certificate. Mainly used for the verify operations.
        - name: extensions
          description: >
            All extensions that were encountered in the certificate.
        - name: san
          description: >
            Subject alternative name extension of the certificate.
        - name: basic_constraints
          description: >
            Basic constraints extension of the certificate.
        - name: logcert
          type: boolean
          description: >
            (present if policy/protocols/ssl/log-hostcerts-only.bro is loaded)

